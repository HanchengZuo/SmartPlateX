{% extends "layout.html" %}
{% block content %}

<div class="section" id="step2">
    <h2>è§†é¢‘åº“ï¼ˆæŒ‰æ—¶é—´å€’åºï¼‰</h2>
    <form method="get" action="/videos">
        <label for="selected">é€‰æ‹©å¾…æŸ¥çœ‹çš„è§†é¢‘ï¼š</label>
        <select name="selected" id="selected" required>
            <option value="" {% if not selected_filename %}selected{% endif %}>-- è¯·é€‰æ‹© --</option>
            {% for video in videos %}
            <option value="{{ video.name }}">{{ video.original_filename }} | {{ video.name }} | {{ video.duration }} ç§’
            </option>
            {% endfor %}
        </select>
        <button type="submit" class="btn">ç¡®å®š</button>
    </form>

    {% if videos %}
    <ul>
        {% for video in videos %}
        <li class="video-item">
            <strong>åŸæ–‡ä»¶åï¼š</strong>{{ video.original_name }}<br>
            <strong>ç³»ç»Ÿæ–‡ä»¶åï¼š</strong>{{ video.name }}<br>
            <strong>ä¸Šä¼ æ—¶é—´ï¼š</strong>{{ video.created_time | datetimeformat }}<br>
            <strong>è§†é¢‘æ—¶é•¿ï¼š</strong>{{ video.duration }} ç§’ -
            <a href="{{ video.url }}" target="_blank">é¢„è§ˆ</a>

            <!-- ğŸ—‘ åˆ é™¤æŒ‰é’® -->
            <form method="post" action="/delete_video" class="delete-form" onsubmit="return confirm('ç¡®è®¤åˆ é™¤è¯¥è§†é¢‘å—ï¼Ÿ')">
                <input type="hidden" name="video_filename" value="{{ video.name }}">
                <button type="submit" class="delete-btn" title="åˆ é™¤è§†é¢‘">Ã—</button>
            </form>
        </li>
        <hr>
        {% endfor %}
    </ul>
    {% else %}
    <p>æš‚æ— è§†é¢‘</p>
    {% endif %}
</div>

{% if selected_video_id %}
<div class="section" id="step4">
    <h2>å¸§å›¾åº“ï¼ˆå½“å‰è§†é¢‘ï¼š{{ selected_video_id }}ï¼‰</h2>

    {% if frames %}
    <div class="frame-grid">
        {% for img in frames %}
        <div class="frame-item">
            <a href="{{ img.url }}" target="_blank">{{ img.name }}</a>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p>æš‚æ— å¸§å›¾ç‰‡</p>
    {% endif %}
</div>
{% endif %}

{% include "_recognition_results.html" %}

<script src="{{ url_for('static', filename='js/recognize.js') }}"></script>


{% endblock %}